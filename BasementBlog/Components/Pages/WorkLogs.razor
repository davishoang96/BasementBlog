@page "/worklogs";
@using BasementBlog.ViewModels;
@using BasementBlog.DTO;
@attribute [Authorize(Roles = "Admin")]

 <MudContainer MaxWidth="MaxWidth.ExtraLarge">
     <MudGrid>
        <MudItem xs="12" sm="6" md="6" lg="6" xl="6" class="mb-4">
            <MudTextField id="post-body" Class="fira-mono-regular"
                          Immediate="true"
                          DisableUnderLine="true"
                          AutoGrow Label="Body"
                          @bind-Value="@vm.Body" />
        </MudItem>

        <MudItem xs="12" sm="6" md="6" lg="6" xl="6" class="mb-4" Style="margin-top: 27px">
            <MudText class="preview-container inter-text-field" >
                @((MarkupString)vm.PreviewBody)
            </MudText>
        </MudItem>
        <MudItem xs="12" Class="floating-button">
            <MudDatePicker PickerVariant="PickerVariant.Static"
                           Rounded="true"
                           AdditionalDateClassesFunc="@((DateTime dt)=>(vm.WorkLogs.Any(s=>s.LoggedDate == dt.Date.ToString(Common.DefaultDateTimeFormat)) ? "green-text text-accent-4" : ""))"
                           @bind-Date="vm.SelectedDate" />
        </MudItem>
    </MudGrid>

   
     <!-- Save button -->
     <MudItem xs="12" Class="floating-button">
         <MudFab Color="Color.Primary" OnClick="@vm.SaveOrUpdateWorkLog" StartIcon="@Icons.Material.Filled.Save" />
     </MudItem>
</MudContainer>

@code{
    
    [Inject]
    private WorkLogsViewModel vm { get; set; }
    protected override async Task OnInitializedAsync()
    {
        await vm.Setup();
    }
}